(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     92477,       2414]
NotebookOptionsPosition[     90171,       2332]
NotebookOutlinePosition[     90513,       2347]
CellTagsIndexPosition[     90470,       2344]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["shimon calculations", "Title",
 CellChangeTimes->{{3.670753049863903*^9, 3.6707530537872477`*^9}}],

Cell[CellGroupData[{

Cell["getting R", "Chapter",
 CellChangeTimes->{{3.670753059454095*^9, 3.6707530659950085`*^9}, {
  3.6708653278743815`*^9, 3.6708653293203487`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"\[Psi]Rule", "=", 
  RowBox[{
   RowBox[{"\[Delta]R", "[", 
    RowBox[{"r_", ",", "\[Theta]_", ",", "z_"}], "]"}], "\[RuleDelayed]", " ", 
   RowBox[{"Normal", "[", " ", 
    RowBox[{"SeriesData", "[", 
     RowBox[{"\[Rho]m", ",", "\[Infinity]", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Psi]0", "[", 
         RowBox[{"r", ",", "\[Theta]", ",", "z"}], "]"}], ",", 
        RowBox[{"\[Psi]1", "[", 
         RowBox[{"r", ",", "\[Theta]", ",", "z"}], "]"}], ",", 
        RowBox[{"\[Psi]2", "[", 
         RowBox[{"r", ",", "\[Theta]", ",", "z"}], "]"}], ",", 
        RowBox[{"\[Psi]3", "[", 
         RowBox[{"r", ",", "\[Theta]", ",", "z"}], "]"}], ",", 
        RowBox[{"\[Psi]4", "[", 
         RowBox[{"r", ",", "\[Theta]", ",", "z"}], "]"}]}], "}"}], ",", "2", 
      ",", "7", ",", "1"}], "]"}], " ", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"\[Rho]s", "=", 
  RowBox[{"\[Rho]", "\[Rule]", " ", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"\[Rho]m", " ", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"-", 
         SuperscriptBox["#1", "2"]}], 
        SuperscriptBox["\[Sigma]", "2"]]]}], "+", "\[Rho]b"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"\[Psi]0s", "=", 
  RowBox[{"\[Psi]0", "\[Rule]", " ", 
   RowBox[{"Function", "[", 
    FractionBox[
     RowBox[{"4", " ", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"2", " ", 
         SuperscriptBox["#1", "2"]}], 
        SuperscriptBox["\[Sigma]", "2"]]], " ", 
      SuperscriptBox["\[Rho]b", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"4", " ", 
         SuperscriptBox["#1", "2"]}], "+", 
        RowBox[{"3", " ", 
         SuperscriptBox["\[Sigma]", "2"]}]}], ")"}]}], 
     SuperscriptBox["\[Sigma]", "4"]], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"\[Psi]1s", "=", 
  RowBox[{"\[Psi]1", "\[Rule]", 
   RowBox[{"Function", "[", " ", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"36", " ", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"3", " ", 
          SuperscriptBox["#1", "2"]}], 
         SuperscriptBox["\[Sigma]", "2"]]], " ", 
       SuperscriptBox["\[Rho]b", "3"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          SuperscriptBox["#1", "2"]}], "+", 
         SuperscriptBox["\[Sigma]", "2"]}], ")"}]}], 
      SuperscriptBox["\[Sigma]", "4"]]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"\[Psi]2s", "=", 
  RowBox[{"\[Psi]2", "\[Rule]", " ", 
   RowBox[{"Function", "[", 
    FractionBox[
     RowBox[{"24", " ", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"4", " ", 
         SuperscriptBox["#1", "2"]}], 
        SuperscriptBox["\[Sigma]", "2"]]], " ", 
      SuperscriptBox["\[Rho]b", "4"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"8", " ", 
         SuperscriptBox["#1", "2"]}], "+", 
        RowBox[{"3", " ", 
         SuperscriptBox["\[Sigma]", "2"]}]}], ")"}]}], 
     SuperscriptBox["\[Sigma]", "4"]], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"\[Psi]3s", "=", 
  RowBox[{"\[Psi]3", "\[Rule]", " ", 
   RowBox[{"Function", "[", 
    FractionBox[
     RowBox[{"8", " ", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"5", " ", 
         SuperscriptBox["#1", "2"]}], 
        SuperscriptBox["\[Sigma]", "2"]]], " ", 
      SuperscriptBox["\[Rho]b", "4"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"400", " ", 
         SuperscriptBox["#1", "4"]}], "+", 
        RowBox[{"3", " ", 
         SuperscriptBox["\[Sigma]", "4"], " ", 
         RowBox[{"(", 
          RowBox[{"38", "+", 
           RowBox[{"5", " ", 
            SuperscriptBox["\[Kappa]", "2"], " ", "\[Rho]b", " ", 
            SuperscriptBox["\[Sigma]", "2"]}]}], ")"}]}], "+", 
        RowBox[{"10", " ", 
         SuperscriptBox["#1", "2"], " ", 
         SuperscriptBox["\[Sigma]", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"58", "+", 
           RowBox[{"5", " ", 
            SuperscriptBox["\[Kappa]", "2"], " ", "\[Rho]b", " ", 
            SuperscriptBox["\[Sigma]", "2"]}]}], ")"}]}]}], ")"}]}], 
     RowBox[{
      SuperscriptBox["\[Kappa]", "2"], " ", 
      SuperscriptBox["\[Sigma]", "8"]}]], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"\[Psi]4s", "=", 
  RowBox[{"\[Psi]4", "\[Rule]", " ", 
   RowBox[{"Function", "[", 
    FractionBox[
     RowBox[{"36", " ", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"6", " ", 
         SuperscriptBox["#1", "2"]}], 
        SuperscriptBox["\[Sigma]", "2"]]], " ", 
      SuperscriptBox["\[Rho]b", "5"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"960", " ", 
         SuperscriptBox["#1", "4"]}], "+", 
        RowBox[{
         SuperscriptBox["\[Sigma]", "4"], " ", 
         RowBox[{"(", 
          RowBox[{"184", "+", 
           RowBox[{"5", " ", 
            SuperscriptBox["\[Kappa]", "2"], " ", "\[Rho]b", " ", 
            SuperscriptBox["\[Sigma]", "2"]}]}], ")"}]}], "+", 
        RowBox[{"4", " ", 
         SuperscriptBox["#1", "2"], " ", 
         SuperscriptBox["\[Sigma]", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"284", "+", 
           RowBox[{"5", " ", 
            SuperscriptBox["\[Kappa]", "2"], " ", "\[Rho]b", " ", 
            SuperscriptBox["\[Sigma]", "2"]}]}], ")"}]}]}], ")"}]}], 
     RowBox[{
      SuperscriptBox["\[Kappa]", "2"], " ", 
      SuperscriptBox["\[Sigma]", "8"]}]], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.670690893844211*^9, 3.670690931428347*^9}, {
   3.670749148947389*^9, 3.670749154980571*^9}, {3.670752470471367*^9, 
   3.670752476857012*^9}, 3.670762938659421*^9, {3.6707714457239857`*^9, 
   3.67077144739439*^9}, {3.670771861607461*^9, 3.670771862355012*^9}, 
   3.6707780830724916`*^9, 3.670778678949394*^9, {3.670778962262446*^9, 
   3.670778965647407*^9}, {3.670779151104282*^9, 3.670779158238288*^9}, {
   3.670779196356679*^9, 3.670779199637463*^9}, {3.670779348467599*^9, 
   3.670779359436759*^9}, {3.670785540521842*^9, 3.670785544818191*^9}, {
   3.670785682334981*^9, 3.670785687191381*^9}, {3.670785797591494*^9, 
   3.670785813780436*^9}, {3.6707861043199663`*^9, 3.670786117889909*^9}, {
   3.670786237226969*^9, 3.6707862499704437`*^9}, {3.670786298544188*^9, 
   3.6707863106313057`*^9}, {3.670786380322752*^9, 3.670786454266138*^9}, {
   3.670786500283204*^9, 3.670786527279417*^9}, {3.6708351515495667`*^9, 
   3.6708351571632347`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Delta]R", "[", 
   RowBox[{"r_", ",", "\[Theta]_", ",", "z_"}], "]"}], "\[RuleDelayed]", 
  RowBox[{"Normal", "[", 
   InterpretationBox[
    RowBox[{
     FractionBox[
      RowBox[{"\[Psi]0", "[", 
       RowBox[{"r", ",", "\[Theta]", ",", "z"}], "]"}], 
      SuperscriptBox["\[Rho]m", "2"]], "+", 
     FractionBox[
      RowBox[{"\[Psi]1", "[", 
       RowBox[{"r", ",", "\[Theta]", ",", "z"}], "]"}], 
      SuperscriptBox["\[Rho]m", "3"]], "+", 
     FractionBox[
      RowBox[{"\[Psi]2", "[", 
       RowBox[{"r", ",", "\[Theta]", ",", "z"}], "]"}], 
      SuperscriptBox["\[Rho]m", "4"]], "+", 
     FractionBox[
      RowBox[{"\[Psi]3", "[", 
       RowBox[{"r", ",", "\[Theta]", ",", "z"}], "]"}], 
      SuperscriptBox["\[Rho]m", "5"]], "+", 
     FractionBox[
      RowBox[{"\[Psi]4", "[", 
       RowBox[{"r", ",", "\[Theta]", ",", "z"}], "]"}], 
      SuperscriptBox["\[Rho]m", "6"]], "+", 
     InterpretationBox[
      SuperscriptBox[
       RowBox[{"O", "[", 
        FractionBox["1", "\[Rho]m"], "]"}], "7"],
      SeriesData[$CellContext`\[Rho]m, Infinity, {}, 2, 7, 1],
      Editable->False]}],
    SeriesData[$CellContext`\[Rho]m, Infinity, {
      $CellContext`\[Psi]0[$CellContext`r, $CellContext`\[Theta], \
$CellContext`z], 
      $CellContext`\[Psi]1[$CellContext`r, $CellContext`\[Theta], \
$CellContext`z], 
      $CellContext`\[Psi]2[$CellContext`r, $CellContext`\[Theta], \
$CellContext`z], 
      $CellContext`\[Psi]3[$CellContext`r, $CellContext`\[Theta], \
$CellContext`z], 
      $CellContext`\[Psi]4[$CellContext`r, $CellContext`\[Theta], \
$CellContext`z]}, 2, 7, 1],
    Editable->False], "]"}]}]], "Output",
 CellChangeTimes->{
  3.670690961840211*^9, 3.670749162595086*^9, 3.670752478326253*^9, 
   3.670762941167943*^9, 3.670764739782031*^9, 3.6707661934529867`*^9, 
   3.670771459149274*^9, 3.670771495478586*^9, 3.6707718644552603`*^9, 
   3.670772288450292*^9, 3.670778679435479*^9, 3.670778966085503*^9, 
   3.670779159929762*^9, 3.670779200847386*^9, {3.670779352799511*^9, 
   3.6707793643465767`*^9}, 3.670779745728455*^9, {3.670784918278857*^9, 
   3.670784936115822*^9}, 3.6707855586902113`*^9, 3.6707856214515133`*^9, 
   3.670785702335395*^9, {3.670785804750046*^9, 3.6707858143324137`*^9}, 
   3.670786118991002*^9, 3.670786252164782*^9, 3.670786311767618*^9, 
   3.670786419963833*^9, 3.6707865294491463`*^9, 3.670834976056086*^9, 
   3.6708351596541348`*^9, 3.6708653428778877`*^9}],

Cell[BoxData[
 RowBox[{"\[Rho]", "\[Rule]", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Rho]m", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox["#1", "2"], 
         SuperscriptBox["\[Sigma]", "2"]]}]]}], "+", "\[Rho]b"}], "&"}], 
   ")"}]}]], "Output",
 CellChangeTimes->{
  3.670690961840211*^9, 3.670749162595086*^9, 3.670752478326253*^9, 
   3.670762941167943*^9, 3.670764739782031*^9, 3.6707661934529867`*^9, 
   3.670771459149274*^9, 3.670771495478586*^9, 3.6707718644552603`*^9, 
   3.670772288450292*^9, 3.670778679435479*^9, 3.670778966085503*^9, 
   3.670779159929762*^9, 3.670779200847386*^9, {3.670779352799511*^9, 
   3.6707793643465767`*^9}, 3.670779745728455*^9, {3.670784918278857*^9, 
   3.670784936115822*^9}, 3.6707855586902113`*^9, 3.6707856214515133`*^9, 
   3.670785702335395*^9, {3.670785804750046*^9, 3.6707858143324137`*^9}, 
   3.670786118991002*^9, 3.670786252164782*^9, 3.670786311767618*^9, 
   3.670786419963833*^9, 3.6707865294491463`*^9, 3.670834976056086*^9, 
   3.6708351596541348`*^9, 3.6708653428778877`*^9}],

Cell[BoxData[
 RowBox[{"\[Psi]0", "\[Rule]", 
  RowBox[{"(", 
   RowBox[{
    FractionBox[
     RowBox[{"4", " ", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"2", " ", 
         SuperscriptBox["#1", "2"]}], 
        SuperscriptBox["\[Sigma]", "2"]]], " ", 
      SuperscriptBox["\[Rho]b", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"4", " ", 
         SuperscriptBox["#1", "2"]}], "+", 
        RowBox[{"3", " ", 
         SuperscriptBox["\[Sigma]", "2"]}]}], ")"}]}], 
     SuperscriptBox["\[Sigma]", "4"]], "&"}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.670690961840211*^9, 3.670749162595086*^9, 3.670752478326253*^9, 
   3.670762941167943*^9, 3.670764739782031*^9, 3.6707661934529867`*^9, 
   3.670771459149274*^9, 3.670771495478586*^9, 3.6707718644552603`*^9, 
   3.670772288450292*^9, 3.670778679435479*^9, 3.670778966085503*^9, 
   3.670779159929762*^9, 3.670779200847386*^9, {3.670779352799511*^9, 
   3.6707793643465767`*^9}, 3.670779745728455*^9, {3.670784918278857*^9, 
   3.670784936115822*^9}, 3.6707855586902113`*^9, 3.6707856214515133`*^9, 
   3.670785702335395*^9, {3.670785804750046*^9, 3.6707858143324137`*^9}, 
   3.670786118991002*^9, 3.670786252164782*^9, 3.670786311767618*^9, 
   3.670786419963833*^9, 3.6707865294491463`*^9, 3.670834976056086*^9, 
   3.6708351596541348`*^9, 3.6708653428935146`*^9}],

Cell[BoxData[
 RowBox[{"\[Psi]1", "\[Rule]", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"36", " ", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"3", " ", 
          SuperscriptBox["#1", "2"]}], 
         SuperscriptBox["\[Sigma]", "2"]]], " ", 
       SuperscriptBox["\[Rho]b", "3"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          SuperscriptBox["#1", "2"]}], "+", 
         SuperscriptBox["\[Sigma]", "2"]}], ")"}]}], 
      SuperscriptBox["\[Sigma]", "4"]]}], "&"}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.670690961840211*^9, 3.670749162595086*^9, 3.670752478326253*^9, 
   3.670762941167943*^9, 3.670764739782031*^9, 3.6707661934529867`*^9, 
   3.670771459149274*^9, 3.670771495478586*^9, 3.6707718644552603`*^9, 
   3.670772288450292*^9, 3.670778679435479*^9, 3.670778966085503*^9, 
   3.670779159929762*^9, 3.670779200847386*^9, {3.670779352799511*^9, 
   3.6707793643465767`*^9}, 3.670779745728455*^9, {3.670784918278857*^9, 
   3.670784936115822*^9}, 3.6707855586902113`*^9, 3.6707856214515133`*^9, 
   3.670785702335395*^9, {3.670785804750046*^9, 3.6707858143324137`*^9}, 
   3.670786118991002*^9, 3.670786252164782*^9, 3.670786311767618*^9, 
   3.670786419963833*^9, 3.6707865294491463`*^9, 3.670834976056086*^9, 
   3.6708351596541348`*^9, 3.6708653429091406`*^9}],

Cell[BoxData[
 RowBox[{"\[Psi]2", "\[Rule]", 
  RowBox[{"(", 
   RowBox[{
    FractionBox[
     RowBox[{"24", " ", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"4", " ", 
         SuperscriptBox["#1", "2"]}], 
        SuperscriptBox["\[Sigma]", "2"]]], " ", 
      SuperscriptBox["\[Rho]b", "4"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"8", " ", 
         SuperscriptBox["#1", "2"]}], "+", 
        RowBox[{"3", " ", 
         SuperscriptBox["\[Sigma]", "2"]}]}], ")"}]}], 
     SuperscriptBox["\[Sigma]", "4"]], "&"}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.670690961840211*^9, 3.670749162595086*^9, 3.670752478326253*^9, 
   3.670762941167943*^9, 3.670764739782031*^9, 3.6707661934529867`*^9, 
   3.670771459149274*^9, 3.670771495478586*^9, 3.6707718644552603`*^9, 
   3.670772288450292*^9, 3.670778679435479*^9, 3.670778966085503*^9, 
   3.670779159929762*^9, 3.670779200847386*^9, {3.670779352799511*^9, 
   3.6707793643465767`*^9}, 3.670779745728455*^9, {3.670784918278857*^9, 
   3.670784936115822*^9}, 3.6707855586902113`*^9, 3.6707856214515133`*^9, 
   3.670785702335395*^9, {3.670785804750046*^9, 3.6707858143324137`*^9}, 
   3.670786118991002*^9, 3.670786252164782*^9, 3.670786311767618*^9, 
   3.670786419963833*^9, 3.6707865294491463`*^9, 3.670834976056086*^9, 
   3.6708351596541348`*^9, 3.6708653429091406`*^9}],

Cell[BoxData[
 RowBox[{"\[Psi]3", "\[Rule]", 
  RowBox[{"(", 
   RowBox[{
    FractionBox[
     RowBox[{"8", " ", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"5", " ", 
         SuperscriptBox["#1", "2"]}], 
        SuperscriptBox["\[Sigma]", "2"]]], " ", 
      SuperscriptBox["\[Rho]b", "4"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"400", " ", 
         SuperscriptBox["#1", "4"]}], "+", 
        RowBox[{"3", " ", 
         SuperscriptBox["\[Sigma]", "4"], " ", 
         RowBox[{"(", 
          RowBox[{"38", "+", 
           RowBox[{"5", " ", 
            SuperscriptBox["\[Kappa]", "2"], " ", "\[Rho]b", " ", 
            SuperscriptBox["\[Sigma]", "2"]}]}], ")"}]}], "+", 
        RowBox[{"10", " ", 
         SuperscriptBox["#1", "2"], " ", 
         SuperscriptBox["\[Sigma]", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"58", "+", 
           RowBox[{"5", " ", 
            SuperscriptBox["\[Kappa]", "2"], " ", "\[Rho]b", " ", 
            SuperscriptBox["\[Sigma]", "2"]}]}], ")"}]}]}], ")"}]}], 
     RowBox[{
      SuperscriptBox["\[Kappa]", "2"], " ", 
      SuperscriptBox["\[Sigma]", "8"]}]], "&"}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.670690961840211*^9, 3.670749162595086*^9, 3.670752478326253*^9, 
   3.670762941167943*^9, 3.670764739782031*^9, 3.6707661934529867`*^9, 
   3.670771459149274*^9, 3.670771495478586*^9, 3.6707718644552603`*^9, 
   3.670772288450292*^9, 3.670778679435479*^9, 3.670778966085503*^9, 
   3.670779159929762*^9, 3.670779200847386*^9, {3.670779352799511*^9, 
   3.6707793643465767`*^9}, 3.670779745728455*^9, {3.670784918278857*^9, 
   3.670784936115822*^9}, 3.6707855586902113`*^9, 3.6707856214515133`*^9, 
   3.670785702335395*^9, {3.670785804750046*^9, 3.6707858143324137`*^9}, 
   3.670786118991002*^9, 3.670786252164782*^9, 3.670786311767618*^9, 
   3.670786419963833*^9, 3.6707865294491463`*^9, 3.670834976056086*^9, 
   3.6708351596541348`*^9, 3.6708653429247713`*^9}],

Cell[BoxData[
 RowBox[{"\[Psi]4", "\[Rule]", 
  RowBox[{"(", 
   RowBox[{
    FractionBox[
     RowBox[{"36", " ", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"6", " ", 
         SuperscriptBox["#1", "2"]}], 
        SuperscriptBox["\[Sigma]", "2"]]], " ", 
      SuperscriptBox["\[Rho]b", "5"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"960", " ", 
         SuperscriptBox["#1", "4"]}], "+", 
        RowBox[{
         SuperscriptBox["\[Sigma]", "4"], " ", 
         RowBox[{"(", 
          RowBox[{"184", "+", 
           RowBox[{"5", " ", 
            SuperscriptBox["\[Kappa]", "2"], " ", "\[Rho]b", " ", 
            SuperscriptBox["\[Sigma]", "2"]}]}], ")"}]}], "+", 
        RowBox[{"4", " ", 
         SuperscriptBox["#1", "2"], " ", 
         SuperscriptBox["\[Sigma]", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"284", "+", 
           RowBox[{"5", " ", 
            SuperscriptBox["\[Kappa]", "2"], " ", "\[Rho]b", " ", 
            SuperscriptBox["\[Sigma]", "2"]}]}], ")"}]}]}], ")"}]}], 
     RowBox[{
      SuperscriptBox["\[Kappa]", "2"], " ", 
      SuperscriptBox["\[Sigma]", "8"]}]], "&"}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.670690961840211*^9, 3.670749162595086*^9, 3.670752478326253*^9, 
   3.670762941167943*^9, 3.670764739782031*^9, 3.6707661934529867`*^9, 
   3.670771459149274*^9, 3.670771495478586*^9, 3.6707718644552603`*^9, 
   3.670772288450292*^9, 3.670778679435479*^9, 3.670778966085503*^9, 
   3.670779159929762*^9, 3.670779200847386*^9, {3.670779352799511*^9, 
   3.6707793643465767`*^9}, 3.670779745728455*^9, {3.670784918278857*^9, 
   3.670784936115822*^9}, 3.6707855586902113`*^9, 3.6707856214515133`*^9, 
   3.670785702335395*^9, {3.670785804750046*^9, 3.6707858143324137`*^9}, 
   3.670786118991002*^9, 3.670786252164782*^9, 3.670786311767618*^9, 
   3.670786419963833*^9, 3.6707865294491463`*^9, 3.670834976056086*^9, 
   3.6708351596541348`*^9, 3.670865342940897*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"equation", "=", 
   RowBox[{
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{"Laplacian", "[", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            SuperscriptBox["\[Kappa]", "2"], "\[Rho]b"}], 
           RowBox[{
            RowBox[{"Replace", "[", 
             RowBox[{
              RowBox[{"\[Delta]R", "[", 
               RowBox[{"r", ",", "\[Theta]", ",", "z"}], "]"}], ",", 
              "\[Psi]Rule"}], "]"}], "+", 
            RowBox[{"ReplaceAll", "[", 
             RowBox[{
              RowBox[{
               SuperscriptBox["\[Kappa]", "2"], 
               RowBox[{"\[Rho]", "[", 
                RowBox[{"r", ",", "\[Theta]", ",", "z"}], "]"}]}], ",", 
              "\[Rho]s"}], "]"}]}]], ")"}], "2"], ",", 
        RowBox[{"{", 
         RowBox[{"r", ",", "\[Theta]", ",", "z"}], "}"}], ",", 
        "\"\<Spherical\>\""}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Rho]m", " ", ",", "\[Infinity]", ",", "6"}], "}"}]}], "]"}],
     "\[Equal]", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{"Replace", "[", 
       RowBox[{
        RowBox[{"\[Delta]R", "[", 
         RowBox[{"r", ",", "\[Theta]", ",", "z"}], "]"}], ",", "\[Psi]Rule"}],
        "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Rho]m", " ", ",", "\[Infinity]", ",", "6"}], "}"}]}], 
     "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.670689211793605*^9, 3.67068938778729*^9}, 
   3.670690023565076*^9, {3.670690060437634*^9, 3.670690359916666*^9}, 
   3.670690477900598*^9, {3.670690681620449*^9, 3.6706906833055563`*^9}, {
   3.6706907587341833`*^9, 3.6706908031007957`*^9}, 3.670690906765399*^9, 
   3.67069095868463*^9, {3.670691251137579*^9, 3.6706912727102537`*^9}, {
   3.6707492519274225`*^9, 3.6707492716846867`*^9}, {3.6707494121228886`*^9, 
   3.6707494164961653`*^9}, {3.670762917462446*^9, 3.670762930764864*^9}, {
   3.670763066123691*^9, 3.6707630726099777`*^9}, {3.6707643467174873`*^9, 
   3.670764350586405*^9}, {3.670764496487392*^9, 3.670764501228063*^9}, 
   3.67076593764132*^9, {3.670766172823029*^9, 3.670766180459531*^9}, {
   3.670767662853149*^9, 3.670767706730713*^9}, {3.670771462102022*^9, 
   3.6707714863471193`*^9}, {3.6707722828865147`*^9, 3.670772284319303*^9}, {
   3.6707792902320423`*^9, 3.67077929034443*^9}, {3.670779762237938*^9, 
   3.6707797626001797`*^9}, {3.670779866597454*^9, 3.670779866988619*^9}, {
   3.670784987663473*^9, 3.670785015796391*^9}, {3.670785582596375*^9, 
   3.670785597547061*^9}, {3.670785691444366*^9, 3.670785692016433*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"SeriesCoefficient", "[", 
      RowBox[{
       RowBox[{"equation", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "i"}], "]"}], "==", 
     RowBox[{"SeriesCoefficient", "[", 
      RowBox[{
       RowBox[{"equation", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", "i"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "2", ",", "4", ",", "1"}], "}"}]}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.6707799259130363`*^9, 3.670779984724052*^9}, 
   3.670780045950173*^9, 3.67078101493102*^9, {3.670785044851322*^9, 
   3.67078505124034*^9}, {3.670785520334262*^9, 3.670785551732979*^9}, 
   3.670785639838073*^9, {3.67078593604774*^9, 3.67078594283077*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
        FractionBox[
         RowBox[{"4", " ", 
          SuperscriptBox["\[ExponentialE]", 
           FractionBox[
            RowBox[{"2", " ", 
             SuperscriptBox["r", "2"]}], 
            SuperscriptBox["\[Sigma]", "2"]]], " ", 
          SuperscriptBox["\[Rho]b", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", 
             SuperscriptBox["r", "2"]}], "+", 
            RowBox[{"3", " ", 
             SuperscriptBox["\[Sigma]", "2"]}]}], ")"}]}], 
         SuperscriptBox["\[Sigma]", "4"]], "\[Equal]", 
        RowBox[{"\[Psi]0", "[", 
         RowBox[{"r", ",", "\[Theta]", ",", "z"}], "]"}]}]},
      {
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"36", " ", 
           SuperscriptBox["\[ExponentialE]", 
            FractionBox[
             RowBox[{"3", " ", 
              SuperscriptBox["r", "2"]}], 
             SuperscriptBox["\[Sigma]", "2"]]], " ", 
           SuperscriptBox["\[Rho]b", "3"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              SuperscriptBox["r", "2"]}], "+", 
             SuperscriptBox["\[Sigma]", "2"]}], ")"}]}], 
          SuperscriptBox["\[Sigma]", "4"]]}], "\[Equal]", 
        RowBox[{"\[Psi]1", "[", 
         RowBox[{"r", ",", "\[Theta]", ",", "z"}], "]"}]}]},
      {
       RowBox[{
        FractionBox[
         RowBox[{"24", " ", 
          SuperscriptBox["\[ExponentialE]", 
           FractionBox[
            RowBox[{"4", " ", 
             SuperscriptBox["r", "2"]}], 
            SuperscriptBox["\[Sigma]", "2"]]], " ", 
          SuperscriptBox["\[Rho]b", "4"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"8", " ", 
             SuperscriptBox["r", "2"]}], "+", 
            RowBox[{"3", " ", 
             SuperscriptBox["\[Sigma]", "2"]}]}], ")"}]}], 
         SuperscriptBox["\[Sigma]", "4"]], "\[Equal]", 
        RowBox[{"\[Psi]2", "[", 
         RowBox[{"r", ",", "\[Theta]", ",", "z"}], "]"}]}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.670780610595436*^9, 3.670781015663656*^9, 3.670785073596862*^9, 
   3.67078564106231*^9, 3.670785708742584*^9, {3.670785936607122*^9, 
   3.670785943248801*^9}, 3.670785980691296*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SeriesCoefficient", "[", 
     RowBox[{
      RowBox[{"equation", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", "5"}], "]"}], "==", 
    RowBox[{"SeriesCoefficient", "[", 
     RowBox[{
      RowBox[{"equation", "[", 
       RowBox[{"[", "2", "]"}], "]"}], ",", "5"}], "]"}]}], "/.", 
   "\[Psi]0s"}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.670766224936021*^9, 3.670766229403751*^9}, {
   3.670779209978672*^9, 3.670779217433474*^9}, {3.670779887345334*^9, 
   3.670779906955028*^9}, 3.670782809369257*^9, {3.670782860133919*^9, 
   3.670782883799303*^9}, {3.670785098303343*^9, 3.670785134608596*^9}, 
   3.670785195639703*^9, {3.670785976294853*^9, 3.6707860046365347`*^9}, {
   3.6707861456268806`*^9, 3.670786151253166*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"8", " ", 
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{"5", " ", 
        SuperscriptBox["r", "2"]}], 
       SuperscriptBox["\[Sigma]", "2"]]], " ", 
     SuperscriptBox["\[Rho]b", "4"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"400", " ", 
        SuperscriptBox["r", "4"]}], "+", 
       RowBox[{"3", " ", 
        SuperscriptBox["\[Sigma]", "4"], " ", 
        RowBox[{"(", 
         RowBox[{"38", "+", 
          RowBox[{"5", " ", 
           SuperscriptBox["\[Kappa]", "2"], " ", "\[Rho]b", " ", 
           SuperscriptBox["\[Sigma]", "2"]}]}], ")"}]}], "+", 
       RowBox[{"10", " ", 
        SuperscriptBox["r", "2"], " ", 
        SuperscriptBox["\[Sigma]", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"58", "+", 
          RowBox[{"5", " ", 
           SuperscriptBox["\[Kappa]", "2"], " ", "\[Rho]b", " ", 
           SuperscriptBox["\[Sigma]", "2"]}]}], ")"}]}]}], ")"}]}], 
    RowBox[{
     SuperscriptBox["\[Kappa]", "2"], " ", 
     SuperscriptBox["\[Sigma]", "8"]}]]}], "\[Equal]", 
  RowBox[{"\[Psi]3", "[", 
   RowBox[{"r", ",", "\[Theta]", ",", "z"}], "]"}]}]], "Output",
 CellChangeTimes->{{3.67077989232519*^9, 3.6707799076477947`*^9}, {
   3.670782801017549*^9, 3.670782810143365*^9}, 3.670782885859827*^9, 
   3.670785081929718*^9, {3.670785122752446*^9, 3.670785135437211*^9}, 
   3.670785198017436*^9, 3.670785261623723*^9, {3.670785309700362*^9, 
   3.670785325692655*^9}, 3.670785955635199*^9, 3.670786010357644*^9, 
   3.670786152119741*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SeriesCoefficient", "[", 
     RowBox[{
      RowBox[{"equation", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", "6"}], "]"}], "==", 
    RowBox[{"SeriesCoefficient", "[", 
     RowBox[{
      RowBox[{"equation", "[", 
       RowBox[{"[", "2", "]"}], "]"}], ",", "6"}], "]"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{"\[Psi]0s", ",", "\[Psi]1s"}], "}"}]}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.670766224936021*^9, 3.670766229403751*^9}, {
   3.670779209978672*^9, 3.670779217433474*^9}, {3.670779887345334*^9, 
   3.670779906955028*^9}, 3.670782809369257*^9, {3.670782860133919*^9, 
   3.670782883799303*^9}, {3.670785098303343*^9, 3.670785134608596*^9}, 
   3.670785195639703*^9, {3.670785976294853*^9, 3.6707860046365347`*^9}, {
   3.670786066505226*^9, 3.67078606915169*^9}, {3.6707861335337353`*^9, 
   3.670786133634882*^9}, {3.670786264326737*^9, 3.670786280130535*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"36", " ", 
    SuperscriptBox["\[ExponentialE]", 
     FractionBox[
      RowBox[{"6", " ", 
       SuperscriptBox["r", "2"]}], 
      SuperscriptBox["\[Sigma]", "2"]]], " ", 
    SuperscriptBox["\[Rho]b", "5"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"960", " ", 
       SuperscriptBox["r", "4"]}], "+", 
      RowBox[{
       SuperscriptBox["\[Sigma]", "4"], " ", 
       RowBox[{"(", 
        RowBox[{"184", "+", 
         RowBox[{"5", " ", 
          SuperscriptBox["\[Kappa]", "2"], " ", "\[Rho]b", " ", 
          SuperscriptBox["\[Sigma]", "2"]}]}], ")"}]}], "+", 
      RowBox[{"4", " ", 
       SuperscriptBox["r", "2"], " ", 
       SuperscriptBox["\[Sigma]", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"284", "+", 
         RowBox[{"5", " ", 
          SuperscriptBox["\[Kappa]", "2"], " ", "\[Rho]b", " ", 
          SuperscriptBox["\[Sigma]", "2"]}]}], ")"}]}]}], ")"}]}], 
   RowBox[{
    SuperscriptBox["\[Kappa]", "2"], " ", 
    SuperscriptBox["\[Sigma]", "8"]}]], "\[Equal]", 
  RowBox[{"\[Psi]4", "[", 
   RowBox[{"r", ",", "\[Theta]", ",", "z"}], "]"}]}]], "Output",
 CellChangeTimes->{
  3.670786071807534*^9, 3.6707861355361013`*^9, {3.670786274223242*^9, 
   3.670786282687155*^9}, 3.670786319019733*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ReplaceAll", "[", 
  RowBox[{
   RowBox[{"SeriesData", "[", 
    RowBox[{"\[Rho]m", ",", "\[Infinity]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Psi]0", "[", 
        RowBox[{"r", ",", "\[Theta]", ",", "z"}], "]"}], ",", 
       RowBox[{"\[Psi]1", "[", 
        RowBox[{"r", ",", "\[Theta]", ",", "z"}], "]"}], ",", 
       RowBox[{"\[Psi]2", "[", 
        RowBox[{"r", ",", "\[Theta]", ",", "z"}], "]"}], ",", 
       RowBox[{"\[Psi]3", "[", 
        RowBox[{"r", ",", "\[Theta]", ",", "z"}], "]"}], ",", 
       RowBox[{"\[Psi]4", "[", 
        RowBox[{"r", ",", "\[Theta]", ",", "z"}], "]"}]}], "}"}], ",", "2", 
     ",", "7", ",", "1"}], "]"}], " ", ",", 
   RowBox[{"{", 
    RowBox[{
    "\[Psi]0s", ",", "\[Psi]1s", ",", "\[Psi]2s", ",", "\[Psi]3s", ",", 
     "\[Psi]4s"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.670786356389285*^9, 3.670786372546545*^9}, {
  3.6707865478915586`*^9, 3.670786549827623*^9}, {3.670786598124159*^9, 
  3.670786626066235*^9}, {3.670786686515295*^9, 3.670786688907567*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   FractionBox[
    RowBox[{"4", " ", 
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{"2", " ", 
        SuperscriptBox["r", "2"]}], 
       SuperscriptBox["\[Sigma]", "2"]]], " ", 
     SuperscriptBox["\[Rho]b", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4", " ", 
        SuperscriptBox["r", "2"]}], "+", 
       RowBox[{"3", " ", 
        SuperscriptBox["\[Sigma]", "2"]}]}], ")"}]}], 
    RowBox[{
     SuperscriptBox["\[Sigma]", "4"], " ", 
     SuperscriptBox["\[Rho]m", "2"]}]], "-", 
   FractionBox[
    RowBox[{"36", " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"3", " ", 
          SuperscriptBox["r", "2"]}], 
         SuperscriptBox["\[Sigma]", "2"]]], " ", 
       SuperscriptBox["\[Rho]b", "3"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          SuperscriptBox["r", "2"]}], "+", 
         SuperscriptBox["\[Sigma]", "2"]}], ")"}]}], ")"}]}], 
    RowBox[{
     SuperscriptBox["\[Sigma]", "4"], " ", 
     SuperscriptBox["\[Rho]m", "3"]}]], "+", 
   FractionBox[
    RowBox[{"24", " ", 
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{"4", " ", 
        SuperscriptBox["r", "2"]}], 
       SuperscriptBox["\[Sigma]", "2"]]], " ", 
     SuperscriptBox["\[Rho]b", "4"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"8", " ", 
        SuperscriptBox["r", "2"]}], "+", 
       RowBox[{"3", " ", 
        SuperscriptBox["\[Sigma]", "2"]}]}], ")"}]}], 
    RowBox[{
     SuperscriptBox["\[Sigma]", "4"], " ", 
     SuperscriptBox["\[Rho]m", "4"]}]], "+", 
   FractionBox[
    RowBox[{"8", " ", 
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{"5", " ", 
        SuperscriptBox["r", "2"]}], 
       SuperscriptBox["\[Sigma]", "2"]]], " ", 
     SuperscriptBox["\[Rho]b", "4"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"400", " ", 
        SuperscriptBox["r", "4"]}], "+", 
       RowBox[{"3", " ", 
        SuperscriptBox["\[Sigma]", "4"], " ", 
        RowBox[{"(", 
         RowBox[{"38", "+", 
          RowBox[{"5", " ", 
           SuperscriptBox["\[Kappa]", "2"], " ", "\[Rho]b", " ", 
           SuperscriptBox["\[Sigma]", "2"]}]}], ")"}]}], "+", 
       RowBox[{"10", " ", 
        SuperscriptBox["r", "2"], " ", 
        SuperscriptBox["\[Sigma]", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"58", "+", 
          RowBox[{"5", " ", 
           SuperscriptBox["\[Kappa]", "2"], " ", "\[Rho]b", " ", 
           SuperscriptBox["\[Sigma]", "2"]}]}], ")"}]}]}], ")"}]}], 
    RowBox[{
     SuperscriptBox["\[Kappa]", "2"], " ", 
     SuperscriptBox["\[Sigma]", "8"], " ", 
     SuperscriptBox["\[Rho]m", "5"]}]], "+", 
   FractionBox[
    RowBox[{"36", " ", 
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{"6", " ", 
        SuperscriptBox["r", "2"]}], 
       SuperscriptBox["\[Sigma]", "2"]]], " ", 
     SuperscriptBox["\[Rho]b", "5"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"960", " ", 
        SuperscriptBox["r", "4"]}], "+", 
       RowBox[{
        SuperscriptBox["\[Sigma]", "4"], " ", 
        RowBox[{"(", 
         RowBox[{"184", "+", 
          RowBox[{"5", " ", 
           SuperscriptBox["\[Kappa]", "2"], " ", "\[Rho]b", " ", 
           SuperscriptBox["\[Sigma]", "2"]}]}], ")"}]}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["r", "2"], " ", 
        SuperscriptBox["\[Sigma]", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"284", "+", 
          RowBox[{"5", " ", 
           SuperscriptBox["\[Kappa]", "2"], " ", "\[Rho]b", " ", 
           SuperscriptBox["\[Sigma]", "2"]}]}], ")"}]}]}], ")"}]}], 
    RowBox[{
     SuperscriptBox["\[Kappa]", "2"], " ", 
     SuperscriptBox["\[Sigma]", "8"], " ", 
     SuperscriptBox["\[Rho]m", "6"]}]], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", 
      FractionBox["1", "\[Rho]m"], "]"}], "7"],
    SeriesData[$CellContext`\[Rho]m, 
     DirectedInfinity[1], {}, 2, 7, 1],
    Editable->False]}],
  SeriesData[$CellContext`\[Rho]m, 
   DirectedInfinity[1], {
   4 E^(2 $CellContext`r^2 $CellContext`\[Sigma]^(-2)) $CellContext`\[Rho]b^2 \
$CellContext`\[Sigma]^(-4) (4 $CellContext`r^2 + 
     3 $CellContext`\[Sigma]^2), (-36) 
    E^(3 $CellContext`r^2 $CellContext`\[Sigma]^(-2)) $CellContext`\[Rho]b^3 \
$CellContext`\[Sigma]^(-4) (2 $CellContext`r^2 + $CellContext`\[Sigma]^2), 24 
    E^(4 $CellContext`r^2 $CellContext`\[Sigma]^(-2)) $CellContext`\[Rho]b^4 \
$CellContext`\[Sigma]^(-4) (8 $CellContext`r^2 + 3 $CellContext`\[Sigma]^2), 
    8 E^(5 $CellContext`r^2 $CellContext`\[Sigma]^(-2)) \
$CellContext`\[Kappa]^(-2) $CellContext`\[Rho]b^4 $CellContext`\[Sigma]^(-8) (
     400 $CellContext`r^4 + 
     3 $CellContext`\[Sigma]^4 (38 + 
       5 $CellContext`\[Kappa]^2 $CellContext`\[Rho]b \
$CellContext`\[Sigma]^2) + 
     10 $CellContext`r^2 $CellContext`\[Sigma]^2 (58 + 
       5 $CellContext`\[Kappa]^2 $CellContext`\[Rho]b \
$CellContext`\[Sigma]^2)), 36 
    E^(6 $CellContext`r^2 $CellContext`\[Sigma]^(-2)) \
$CellContext`\[Kappa]^(-2) $CellContext`\[Rho]b^5 $CellContext`\[Sigma]^(-8) (
     960 $CellContext`r^4 + $CellContext`\[Sigma]^4 (184 + 
       5 $CellContext`\[Kappa]^2 $CellContext`\[Rho]b \
$CellContext`\[Sigma]^2) + 
     4 $CellContext`r^2 $CellContext`\[Sigma]^2 (284 + 
       5 $CellContext`\[Kappa]^2 $CellContext`\[Rho]b \
$CellContext`\[Sigma]^2))}, 2, 7, 1],
  Editable->False]], "Output",
 CellChangeTimes->{{3.670786538084857*^9, 3.670786550184285*^9}, {
   3.67078662086369*^9, 3.6707866266077223`*^9}, 3.6707866892803164`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["getting \[Phi]", "Chapter",
 CellChangeTimes->{{3.670753059454095*^9, 3.6707530659950085`*^9}, {
  3.67086531842795*^9, 3.6708653231883025`*^9}}],

Cell[TextData[{
 "\[Phi] satisfies the laplace equation\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["\[Del]", "2"], "\[Phi]"}], "=", "\[Delta]R"}], 
   TraditionalForm]],
  FormatType->"TraditionalForm"],
 "\nThe solution to which is\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[Phi]", " ", 
     RowBox[{"(", "x", ")"}]}], " ", "=", " ", 
    RowBox[{
     FractionBox[
      RowBox[{"-", "1"}], 
      RowBox[{"4", "\[Pi]"}]], 
     RowBox[{"\[Integral]", 
      RowBox[{
       FractionBox[
        RowBox[{"\[Delta]R", "(", 
         RowBox[{"x", "'"}], ")"}], 
        RowBox[{"|", 
         RowBox[{"x", "-", 
          RowBox[{"x", "'"}]}], "|"}]], 
       SuperscriptBox["d", "3"], 
       RowBox[{"x", "'"}]}]}]}]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "\nand using\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox["1", 
     RowBox[{"|", 
      RowBox[{"x", "-", 
       RowBox[{"x", "'"}]}], "|"}]], "=", 
    RowBox[{
     RowBox[{"\[Sum]", 
      RowBox[{
       FractionBox[
        SuperscriptBox[
         SubscriptBox["r", "<"], "l"], 
        SuperscriptBox[
         SubscriptBox["r", ">"], 
         RowBox[{"l", "+", "1"}]]], 
       RowBox[{
        SubscriptBox["P", "l"], "(", 
        RowBox[{"cos", " ", "\[Gamma]"}], ")"}]}]}], "=", 
     RowBox[{
      UnderscriptBox["\[Sum]", 
       RowBox[{"l", "=", "0"}]], 
      RowBox[{
       FractionBox[
        SuperscriptBox[
         SubscriptBox["r", "<"], "l"], 
        SuperscriptBox[
         SubscriptBox["r", ">"], 
         RowBox[{"l", "+", "1"}]]], 
       RowBox[{
        SubscriptBox["P", "l"], "(", 
        FractionBox[
         RowBox[{"x", " ", 
          RowBox[{"x", "'"}]}], 
         RowBox[{"|", 
          RowBox[{"x", "||", 
           RowBox[{"x", "'"}]}], "|"}]], ")"}]}]}]}]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "\nWe express the overall integral as a sum of two integrals. One over the \
interior of the ball of radius r and one over the exterior.\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[Phi]", " ", 
     RowBox[{"(", "r", ")"}]}], " ", "=", " ", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{"-", "1"}], 
       RowBox[{"4", "\[Pi]"}]], 
      RowBox[{
       UnderscriptBox["\[Sum]", 
        RowBox[{"l", "=", "0"}]], 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["\[Integral]", 
          RowBox[{
           RowBox[{"r", "'"}], "=", "0"}]], "r"], 
        RowBox[{
         FractionBox[
          SuperscriptBox[
           RowBox[{"r", "'"}], "l"], 
          SuperscriptBox["r", 
           RowBox[{"l", "+", "1"}]]], 
         RowBox[{
          SubscriptBox["P", "l"], "(", 
          FractionBox[
           RowBox[{"x", " ", 
            RowBox[{"x", "'"}]}], 
           RowBox[{"r", " ", 
            RowBox[{"r", "'"}]}]], ")"}], 
         RowBox[{"\[Delta]R", "(", 
          RowBox[{"r", "'"}], ")"}], 
         SuperscriptBox["d", "3"], 
         RowBox[{"x", "'"}]}]}]}]}], "+", 
     RowBox[{
      FractionBox[
       RowBox[{"-", "1"}], 
       RowBox[{"4", "\[Pi]"}]], 
      RowBox[{
       UnderscriptBox["\[Sum]", 
        RowBox[{"l", "=", "0"}]], 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["\[Integral]", 
          RowBox[{
           RowBox[{"r", "'"}], "=", "r"}]], "\[Infinity]"], 
        RowBox[{
         FractionBox[
          SuperscriptBox["r", "l"], 
          SuperscriptBox[
           RowBox[{"r", "'"}], 
           RowBox[{"l", "+", "1"}]]], 
         RowBox[{
          SubscriptBox["P", "l"], "(", 
          FractionBox[
           RowBox[{"x", " ", 
            RowBox[{"x", "'"}]}], 
           RowBox[{"r", " ", 
            RowBox[{"r", "'"}]}]], ")"}], 
         RowBox[{"\[Delta]R", "(", 
          RowBox[{"r", "'"}], ")"}], 
         SuperscriptBox["d", "3"], 
         RowBox[{"x", "'"}]}]}]}]}]}]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "\nNow the angle inside the Legendre function doesn\[CloseCurlyQuote]t \
depend on the radii and because \[Delta]R only depends on the radius we can \
integrate over the angles and by the orthogonality of the Legendre \
polynomials we get\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[Phi]", " ", 
     RowBox[{"(", "r", ")"}]}], " ", "=", " ", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{"-", "1"}], 
       RowBox[{"2", "\[Pi]"}]], 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["\[Integral]", 
         RowBox[{
          RowBox[{"r", "'"}], "=", "0"}]], "r"], 
       RowBox[{
        FractionBox["1", "r"], 
        RowBox[{"\[Delta]R", "(", 
         RowBox[{"r", "'"}], ")"}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"r", "'"}], ")"}], "2"], 
        RowBox[{"dr", "'"}]}]}]}], "+", 
     RowBox[{
      FractionBox[
       RowBox[{"-", "1"}], 
       RowBox[{"2", "\[Pi]"}]], 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["\[Integral]", 
         RowBox[{
          RowBox[{"r", "'"}], "=", "r"}]], "\[Infinity]"], 
       RowBox[{
        RowBox[{"\[Delta]R", "(", 
         RowBox[{"r", "'"}], ")"}], 
        RowBox[{"r", "'"}], 
        RowBox[{"dr", "'"}]}]}]}]}]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "\nThis unfortunately diverges..\nSince the potential is only defined up to \
a constant we define\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[Phi]", " ", 
     RowBox[{"(", 
      RowBox[{"r", "<", "\[Sigma]"}], ")"}]}], " ", "=", " ", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{"-", "1"}], 
       RowBox[{"2", "\[Pi]"}]], 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["\[Integral]", 
         RowBox[{
          RowBox[{"r", "'"}], "=", "0"}]], "r"], 
       RowBox[{
        FractionBox["1", "r"], 
        RowBox[{"\[Delta]R", "(", 
         RowBox[{"r", "'"}], ")"}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"r", "'"}], ")"}], "2"], 
        RowBox[{"dr", "'"}]}]}]}], "+", 
     RowBox[{
      FractionBox[
       RowBox[{"-", "1"}], 
       RowBox[{"2", "\[Pi]"}]], 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["\[Integral]", 
         RowBox[{
          RowBox[{"r", "'"}], "=", "r"}]], "\[Sigma]"], 
       RowBox[{
        RowBox[{"\[Delta]R", "(", 
         RowBox[{"r", "'"}], ")"}], 
        RowBox[{"r", "'"}], 
        RowBox[{"dr", "'"}]}]}]}]}]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[Phi]", " ", 
     RowBox[{"(", 
      RowBox[{"r", ">", "\[Sigma]"}], ")"}]}], " ", "=", " ", 
    RowBox[{"Const", "=", 
     RowBox[{
      FractionBox[
       RowBox[{"-", "1"}], 
       RowBox[{"2", "\[Pi]"}]], 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["\[Integral]", 
         RowBox[{
          RowBox[{"r", "'"}], "=", "0"}]], "\[Sigma]"], 
       RowBox[{
        FractionBox["1", "\[Sigma]"], 
        RowBox[{"\[Delta]R", "(", 
         RowBox[{"r", "'"}], ")"}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"r", "'"}], ")"}], "2"], 
        RowBox[{"dr", "'"}]}]}]}]}]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "\nIn effect we substracted the infinite (constant) contribution from beyond \
a cutoff which was set at r=\[Sigma].\nWe now calculate this"
}], "Text",
 CellChangeTimes->{{3.670867929131449*^9, 3.670867960783749*^9}, {
   3.6708680019998646`*^9, 3.6708681306292753`*^9}, {3.670868232559104*^9, 
   3.6708682421703715`*^9}, {3.670869749035944*^9, 3.6708698228367505`*^9}, 
   3.670869863307298*^9, {3.6708700074921703`*^9, 3.670870069227368*^9}, {
   3.670870177009894*^9, 3.6708702366979403`*^9}, {3.6708703261838017`*^9, 
   3.6708704641631985`*^9}, {3.670870534408579*^9, 3.670870579512209*^9}, {
   3.6708706408522215`*^9, 3.670870716851878*^9}, {3.670870894038351*^9, 
   3.6708710204200444`*^9}, {3.6708713650863895`*^9, 
   3.6708714297343483`*^9}, {3.6708715388215685`*^9, 3.670871651593379*^9}, {
   3.6708719862815685`*^9, 3.6708720412402883`*^9}, {3.6708733345944557`*^9, 
   3.670873337396022*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Delta]R1", "[", 
   RowBox[{"r_", ",", "\[Theta]_", ",", "\[CurlyPhi]_"}], "]"}], ":=", 
  RowBox[{"ReplaceAll", "[", 
   RowBox[{
    RowBox[{"ReplaceAll", "[", 
     RowBox[{
      RowBox[{"\[Delta]R", "[", 
       RowBox[{"r", ",", "\[Theta]", ",", "\[CurlyPhi]"}], "]"}], ",", 
      "\[Psi]Rule"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "\[Psi]0s", ",", "\[Psi]1s", ",", "\[Psi]2s", ",", "\[Psi]3s", ",", 
      "\[Psi]4s"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Phi]", "[", 
   RowBox[{"R_", ",", "\[Theta]_", ",", "\[CurlyPhi]_"}], "]"}], ":=", 
  RowBox[{"Piecewise", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", 
           RowBox[{"2", "\[Pi]", " ", "R"}]]}], 
         RowBox[{"Integrate", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Delta]R1", "[", 
             RowBox[{"r", ",", "\[Theta]", ",", "\[CurlyPhi]"}], "]"}], 
            SuperscriptBox["r", "2"]}], ",", 
           RowBox[{"{", 
            RowBox[{"r", ",", "0", ",", "R"}], "}"}]}], "]"}]}], "-", 
        RowBox[{
         FractionBox["1", 
          RowBox[{"2", "\[Pi]"}]], 
         RowBox[{"Integrate", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Delta]R1", "[", 
             RowBox[{"r", ",", "\[Theta]", ",", "\[CurlyPhi]"}], "]"}], "r"}],
            ",", 
           RowBox[{"{", 
            RowBox[{"r", ",", "R", ",", "\[Sigma]"}], "}"}]}], "]"}]}]}], ",", 
       RowBox[{"R", "<", "\[Sigma]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", 
          RowBox[{"2", "\[Pi]", " ", "\[Sigma]"}]]}], 
        RowBox[{"Integrate", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Delta]R1", "[", 
            RowBox[{"r", ",", "\[Theta]", ",", "\[CurlyPhi]"}], "]"}], 
           SuperscriptBox["r", "2"]}], ",", 
          RowBox[{"{", 
           RowBox[{"r", ",", "0", ",", "\[Sigma]"}], "}"}]}], "]"}]}], ",", 
       RowBox[{"R", "\[GreaterEqual]", " ", "\[Sigma]"}]}], "}"}]}], "}"}], 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.6708350194633045`*^9, 3.670835140234088*^9}, {
   3.670868148384785*^9, 3.6708682118494205`*^9}, {3.670871681111478*^9, 
   3.6708716835076685`*^9}, {3.6708717277690363`*^9, 3.670871970720705*^9}, {
   3.670872065787989*^9, 3.6708721170457015`*^9}, 3.6708721554906425`*^9, {
   3.670872899037964*^9, 3.6708729022242775`*^9}, {3.670873345866753*^9, 
   3.670873346417667*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Phi]", "[", 
  RowBox[{"R", ",", "\[Theta]", ",", "\[CurlyPhi]"}], "]"}]], "Input",
 CellChangeTimes->{{3.670872862311714*^9, 3.6708728650361814`*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{
         RowBox[{"-", 
          RowBox[{
           FractionBox["1", 
            RowBox[{"\[Pi]", " ", 
             SuperscriptBox["\[Kappa]", "2"], " ", 
             SuperscriptBox["\[Rho]m", "6"], " ", 
             SuperscriptBox["\[Sigma]", "6"]}]], 
           RowBox[{"2", " ", 
            SuperscriptBox["\[ExponentialE]", 
             FractionBox[
              RowBox[{"2", " ", 
               SuperscriptBox["R", "2"]}], 
              SuperscriptBox["\[Sigma]", "2"]]], " ", 
            SuperscriptBox["R", "2"], " ", 
            SuperscriptBox["\[Rho]b", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"6", " ", 
               SuperscriptBox["\[ExponentialE]", 
                FractionBox[
                 RowBox[{"2", " ", 
                  SuperscriptBox["R", "2"]}], 
                 SuperscriptBox["\[Sigma]", "2"]]], " ", 
               SuperscriptBox["\[Kappa]", "2"], " ", 
               SuperscriptBox["\[Rho]b", "2"], " ", 
               SuperscriptBox["\[Rho]m", "2"], " ", 
               SuperscriptBox["\[Sigma]", "4"]}], "-", 
              RowBox[{"3", " ", 
               SuperscriptBox["\[ExponentialE]", 
                FractionBox[
                 SuperscriptBox["R", "2"], 
                 SuperscriptBox["\[Sigma]", "2"]]], " ", 
               SuperscriptBox["\[Kappa]", "2"], " ", "\[Rho]b", " ", 
               SuperscriptBox["\[Rho]m", "3"], " ", 
               SuperscriptBox["\[Sigma]", "4"]}], "+", 
              RowBox[{
               SuperscriptBox["\[Kappa]", "2"], " ", 
               SuperscriptBox["\[Rho]m", "4"], " ", 
               SuperscriptBox["\[Sigma]", "4"]}], "+", 
              RowBox[{"2", " ", 
               SuperscriptBox["\[ExponentialE]", 
                FractionBox[
                 RowBox[{"3", " ", 
                  SuperscriptBox["R", "2"]}], 
                 SuperscriptBox["\[Sigma]", "2"]]], " ", 
               SuperscriptBox["\[Rho]b", "2"], " ", "\[Rho]m", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"40", " ", 
                  SuperscriptBox["R", "2"]}], "+", 
                 RowBox[{"38", " ", 
                  SuperscriptBox["\[Sigma]", "2"]}], "+", 
                 RowBox[{"5", " ", 
                  SuperscriptBox["\[Kappa]", "2"], " ", "\[Rho]b", " ", 
                  SuperscriptBox["\[Sigma]", "4"]}]}], ")"}]}], "+", 
              RowBox[{"3", " ", 
               SuperscriptBox["\[ExponentialE]", 
                FractionBox[
                 RowBox[{"4", " ", 
                  SuperscriptBox["R", "2"]}], 
                 SuperscriptBox["\[Sigma]", "2"]]], " ", 
               SuperscriptBox["\[Rho]b", "3"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"240", " ", 
                  SuperscriptBox["R", "2"]}], "+", 
                 RowBox[{"184", " ", 
                  SuperscriptBox["\[Sigma]", "2"]}], "+", 
                 RowBox[{"5", " ", 
                  SuperscriptBox["\[Kappa]", "2"], " ", "\[Rho]b", " ", 
                  SuperscriptBox["\[Sigma]", "4"]}]}], ")"}]}]}], ")"}]}]}]}],
          "-", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"2", " ", "\[Pi]", " ", 
            SuperscriptBox["\[Kappa]", "2"], " ", 
            SuperscriptBox["\[Rho]m", "6"], " ", 
            SuperscriptBox["\[Sigma]", "6"]}]], 
          RowBox[{
           SuperscriptBox["\[Rho]b", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"8", " ", 
              SuperscriptBox["\[ExponentialE]", "5"], " ", 
              SuperscriptBox["\[Rho]b", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"684", " ", "\[ExponentialE]", " ", "\[Rho]b"}], "+", 
                RowBox[{"85", " ", "\[Rho]m"}]}], ")"}], " ", 
              SuperscriptBox["\[Sigma]", "4"]}], "+", 
             RowBox[{
              SuperscriptBox["\[ExponentialE]", "2"], " ", 
              SuperscriptBox["\[Kappa]", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"65", " ", 
                 SuperscriptBox["\[ExponentialE]", "4"], " ", 
                 SuperscriptBox["\[Rho]b", "4"]}], "+", 
                RowBox[{"44", " ", 
                 SuperscriptBox["\[ExponentialE]", "3"], " ", 
                 SuperscriptBox["\[Rho]b", "3"], " ", "\[Rho]m"}], "+", 
                RowBox[{"27", " ", 
                 SuperscriptBox["\[ExponentialE]", "2"], " ", 
                 SuperscriptBox["\[Rho]b", "2"], " ", 
                 SuperscriptBox["\[Rho]m", "2"]}], "-", 
                RowBox[{"14", " ", "\[ExponentialE]", " ", "\[Rho]b", " ", 
                 SuperscriptBox["\[Rho]m", "3"]}], "+", 
                RowBox[{"5", " ", 
                 SuperscriptBox["\[Rho]m", "4"]}]}], ")"}], " ", 
              SuperscriptBox["\[Sigma]", "6"]}], "-", 
             RowBox[{
              SuperscriptBox["\[ExponentialE]", 
               FractionBox[
                RowBox[{"2", " ", 
                 SuperscriptBox["R", "2"]}], 
                SuperscriptBox["\[Sigma]", "2"]]], " ", 
              SuperscriptBox["\[Kappa]", "2"], " ", 
              SuperscriptBox["\[Rho]m", "4"], " ", 
              SuperscriptBox["\[Sigma]", "4"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"4", " ", 
                 SuperscriptBox["R", "2"]}], "+", 
                SuperscriptBox["\[Sigma]", "2"]}], ")"}]}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["\[ExponentialE]", 
               FractionBox[
                RowBox[{"3", " ", 
                 SuperscriptBox["R", "2"]}], 
                SuperscriptBox["\[Sigma]", "2"]]], " ", 
              SuperscriptBox["\[Kappa]", "2"], " ", "\[Rho]b", " ", 
              SuperscriptBox["\[Rho]m", "3"], " ", 
              SuperscriptBox["\[Sigma]", "4"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"6", " ", 
                 SuperscriptBox["R", "2"]}], "+", 
                SuperscriptBox["\[Sigma]", "2"]}], ")"}]}], "-", 
             RowBox[{"3", " ", 
              SuperscriptBox["\[ExponentialE]", 
               FractionBox[
                RowBox[{"4", " ", 
                 SuperscriptBox["R", "2"]}], 
                SuperscriptBox["\[Sigma]", "2"]]], " ", 
              SuperscriptBox["\[Kappa]", "2"], " ", 
              SuperscriptBox["\[Rho]b", "2"], " ", 
              SuperscriptBox["\[Rho]m", "2"], " ", 
              SuperscriptBox["\[Sigma]", "4"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"8", " ", 
                 SuperscriptBox["R", "2"]}], "+", 
                SuperscriptBox["\[Sigma]", "2"]}], ")"}]}], "-", 
             RowBox[{"4", " ", 
              SuperscriptBox["\[ExponentialE]", 
               FractionBox[
                RowBox[{"5", " ", 
                 SuperscriptBox["R", "2"]}], 
                SuperscriptBox["\[Sigma]", "2"]]], " ", 
              SuperscriptBox["\[Rho]b", "2"], " ", "\[Rho]m", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"80", " ", 
                 SuperscriptBox["R", "4"]}], "+", 
                RowBox[{"84", " ", 
                 SuperscriptBox["R", "2"], " ", 
                 SuperscriptBox["\[Sigma]", "2"]}], "+", 
                RowBox[{"2", " ", 
                 RowBox[{"(", 
                  RowBox[{"3", "+", 
                   RowBox[{"5", " ", 
                    SuperscriptBox["R", "2"], " ", 
                    SuperscriptBox["\[Kappa]", "2"], " ", "\[Rho]b"}]}], 
                  ")"}], " ", 
                 SuperscriptBox["\[Sigma]", "4"]}], "+", 
                RowBox[{
                 SuperscriptBox["\[Kappa]", "2"], " ", "\[Rho]b", " ", 
                 SuperscriptBox["\[Sigma]", "6"]}]}], ")"}]}], "-", 
             RowBox[{
              SuperscriptBox["\[ExponentialE]", 
               FractionBox[
                RowBox[{"6", " ", 
                 SuperscriptBox["R", "2"]}], 
                SuperscriptBox["\[Sigma]", "2"]]], " ", 
              SuperscriptBox["\[Rho]b", "3"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2880", " ", 
                 SuperscriptBox["R", "4"]}], "+", 
                RowBox[{"2448", " ", 
                 SuperscriptBox["R", "2"], " ", 
                 SuperscriptBox["\[Sigma]", "2"]}], "+", 
                RowBox[{"12", " ", 
                 RowBox[{"(", 
                  RowBox[{"12", "+", 
                   RowBox[{"5", " ", 
                    SuperscriptBox["R", "2"], " ", 
                    SuperscriptBox["\[Kappa]", "2"], " ", "\[Rho]b"}]}], 
                  ")"}], " ", 
                 SuperscriptBox["\[Sigma]", "4"]}], "+", 
                RowBox[{"5", " ", 
                 SuperscriptBox["\[Kappa]", "2"], " ", "\[Rho]b", " ", 
                 SuperscriptBox["\[Sigma]", "6"]}]}], ")"}]}]}], ")"}]}]}]}], 
        RowBox[{"R", "<", "\[Sigma]"}]},
       {
        RowBox[{"-", 
         FractionBox[
          RowBox[{"2", " ", 
           SuperscriptBox["\[ExponentialE]", "2"], " ", 
           SuperscriptBox["\[Rho]b", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              RowBox[{"12", " ", 
               SuperscriptBox["\[ExponentialE]", "3"], " ", 
               SuperscriptBox["\[Rho]b", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"106", " ", "\[ExponentialE]", " ", "\[Rho]b"}], "+", 
                 RowBox[{"13", " ", "\[Rho]m"}]}], ")"}]}], 
              SuperscriptBox["\[Kappa]", "2"]], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"15", " ", 
                 SuperscriptBox["\[ExponentialE]", "4"], " ", 
                 SuperscriptBox["\[Rho]b", "4"]}], "+", 
                RowBox[{"10", " ", 
                 SuperscriptBox["\[ExponentialE]", "3"], " ", 
                 SuperscriptBox["\[Rho]b", "3"], " ", "\[Rho]m"}], "+", 
                RowBox[{"6", " ", 
                 SuperscriptBox["\[ExponentialE]", "2"], " ", 
                 SuperscriptBox["\[Rho]b", "2"], " ", 
                 SuperscriptBox["\[Rho]m", "2"]}], "-", 
                RowBox[{"3", " ", "\[ExponentialE]", " ", "\[Rho]b", " ", 
                 SuperscriptBox["\[Rho]m", "3"]}], "+", 
                SuperscriptBox["\[Rho]m", "4"]}], ")"}], " ", 
              SuperscriptBox["\[Sigma]", "2"]}]}], ")"}]}], 
          RowBox[{"\[Pi]", " ", 
           SuperscriptBox["\[Rho]m", "6"], " ", 
           SuperscriptBox["\[Sigma]", "2"]}]]}], 
        RowBox[{"R", "\[GreaterEqual]", "\[Sigma]"}]},
       {"0", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{
       "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}},
      Selectable->True]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxItemSize->{
    "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{3.6708728697230873`*^9, 3.670872906178943*^9, 
  3.6708733524737515`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "getting ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["a", "5"], TraditionalForm]],
  FormatType->"TraditionalForm"]
}], "Chapter",
 CellChangeTimes->{{3.670753059454095*^9, 3.6707530659950085`*^9}, {
  3.67086531842795*^9, 3.6708653231883025`*^9}, {3.670873151852832*^9, 
  3.670873152970756*^9}}],

Cell[TextData[{
 "All we have left is to take the gradient of \[Phi] to get ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["a", "5"], TraditionalForm]],
  FormatType->"TraditionalForm"]
}], "Text",
 CellChangeTimes->{{3.6708731391508512`*^9, 3.6708731777917747`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"a5", "[", 
   RowBox[{"R_", ",", "\[Theta]_", ",", "\[CurlyPhi]_"}], "]"}], ":=", 
  RowBox[{"Grad", "[", 
   RowBox[{
    RowBox[{"\[Phi]", "[", 
     RowBox[{"R", ",", "\[Theta]", ",", "\[CurlyPhi]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"R", ",", "\[Theta]", ",", "\[CurlyPhi]"}], "}"}], ",", 
    "\"\<Spherical\>\""}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6708732035387*^9, 3.6708732800330667`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"a5", "[", 
  RowBox[{"R", ",", "\[Theta]", ",", "\[CurlyPhi]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6708732861850348`*^9, 3.6708732880701056`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[GridBox[{
      {"\[Piecewise]", GridBox[{
         {
          RowBox[{
           RowBox[{"-", 
            RowBox[{
             FractionBox["1", 
              RowBox[{"\[Pi]", " ", 
               SuperscriptBox["\[Kappa]", "2"], " ", 
               SuperscriptBox["\[Rho]m", "6"], " ", 
               SuperscriptBox["\[Sigma]", "8"]}]], 
             RowBox[{"8", " ", 
              SuperscriptBox["\[ExponentialE]", 
               FractionBox[
                RowBox[{"2", " ", 
                 SuperscriptBox["R", "2"]}], 
                SuperscriptBox["\[Sigma]", "2"]]], " ", 
              SuperscriptBox["R", "3"], " ", 
              SuperscriptBox["\[Rho]b", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"6", " ", 
                 SuperscriptBox["\[ExponentialE]", 
                  FractionBox[
                   RowBox[{"2", " ", 
                    SuperscriptBox["R", "2"]}], 
                   SuperscriptBox["\[Sigma]", "2"]]], " ", 
                 SuperscriptBox["\[Kappa]", "2"], " ", 
                 SuperscriptBox["\[Rho]b", "2"], " ", 
                 SuperscriptBox["\[Rho]m", "2"], " ", 
                 SuperscriptBox["\[Sigma]", "4"]}], "-", 
                RowBox[{"3", " ", 
                 SuperscriptBox["\[ExponentialE]", 
                  FractionBox[
                   SuperscriptBox["R", "2"], 
                   SuperscriptBox["\[Sigma]", "2"]]], " ", 
                 SuperscriptBox["\[Kappa]", "2"], " ", "\[Rho]b", " ", 
                 SuperscriptBox["\[Rho]m", "3"], " ", 
                 SuperscriptBox["\[Sigma]", "4"]}], "+", 
                RowBox[{
                 SuperscriptBox["\[Kappa]", "2"], " ", 
                 SuperscriptBox["\[Rho]m", "4"], " ", 
                 SuperscriptBox["\[Sigma]", "4"]}], "+", 
                RowBox[{"2", " ", 
                 SuperscriptBox["\[ExponentialE]", 
                  FractionBox[
                   RowBox[{"3", " ", 
                    SuperscriptBox["R", "2"]}], 
                   SuperscriptBox["\[Sigma]", "2"]]], " ", 
                 SuperscriptBox["\[Rho]b", "2"], " ", "\[Rho]m", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"40", " ", 
                    SuperscriptBox["R", "2"]}], "+", 
                   RowBox[{"38", " ", 
                    SuperscriptBox["\[Sigma]", "2"]}], "+", 
                   RowBox[{"5", " ", 
                    SuperscriptBox["\[Kappa]", "2"], " ", "\[Rho]b", " ", 
                    SuperscriptBox["\[Sigma]", "4"]}]}], ")"}]}], "+", 
                RowBox[{"3", " ", 
                 SuperscriptBox["\[ExponentialE]", 
                  FractionBox[
                   RowBox[{"4", " ", 
                    SuperscriptBox["R", "2"]}], 
                   SuperscriptBox["\[Sigma]", "2"]]], " ", 
                 SuperscriptBox["\[Rho]b", "3"], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"240", " ", 
                    SuperscriptBox["R", "2"]}], "+", 
                   RowBox[{"184", " ", 
                    SuperscriptBox["\[Sigma]", "2"]}], "+", 
                   RowBox[{"5", " ", 
                    SuperscriptBox["\[Kappa]", "2"], " ", "\[Rho]b", " ", 
                    SuperscriptBox["\[Sigma]", "4"]}]}], ")"}]}]}], 
               ")"}]}]}]}], "-", 
           RowBox[{
            FractionBox["1", 
             RowBox[{"\[Pi]", " ", 
              SuperscriptBox["\[Kappa]", "2"], " ", 
              SuperscriptBox["\[Rho]m", "6"], " ", 
              SuperscriptBox["\[Sigma]", "6"]}]], 
            RowBox[{"4", " ", 
             SuperscriptBox["\[ExponentialE]", 
              FractionBox[
               RowBox[{"2", " ", 
                SuperscriptBox["R", "2"]}], 
               SuperscriptBox["\[Sigma]", "2"]]], " ", "R", " ", 
             SuperscriptBox["\[Rho]b", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"6", " ", 
                SuperscriptBox["\[ExponentialE]", 
                 FractionBox[
                  RowBox[{"2", " ", 
                   SuperscriptBox["R", "2"]}], 
                  SuperscriptBox["\[Sigma]", "2"]]], " ", 
                SuperscriptBox["\[Kappa]", "2"], " ", 
                SuperscriptBox["\[Rho]b", "2"], " ", 
                SuperscriptBox["\[Rho]m", "2"], " ", 
                SuperscriptBox["\[Sigma]", "4"]}], "-", 
               RowBox[{"3", " ", 
                SuperscriptBox["\[ExponentialE]", 
                 FractionBox[
                  SuperscriptBox["R", "2"], 
                  SuperscriptBox["\[Sigma]", "2"]]], " ", 
                SuperscriptBox["\[Kappa]", "2"], " ", "\[Rho]b", " ", 
                SuperscriptBox["\[Rho]m", "3"], " ", 
                SuperscriptBox["\[Sigma]", "4"]}], "+", 
               RowBox[{
                SuperscriptBox["\[Kappa]", "2"], " ", 
                SuperscriptBox["\[Rho]m", "4"], " ", 
                SuperscriptBox["\[Sigma]", "4"]}], "+", 
               RowBox[{"2", " ", 
                SuperscriptBox["\[ExponentialE]", 
                 FractionBox[
                  RowBox[{"3", " ", 
                   SuperscriptBox["R", "2"]}], 
                  SuperscriptBox["\[Sigma]", "2"]]], " ", 
                SuperscriptBox["\[Rho]b", "2"], " ", "\[Rho]m", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"40", " ", 
                   SuperscriptBox["R", "2"]}], "+", 
                  RowBox[{"38", " ", 
                   SuperscriptBox["\[Sigma]", "2"]}], "+", 
                  RowBox[{"5", " ", 
                   SuperscriptBox["\[Kappa]", "2"], " ", "\[Rho]b", " ", 
                   SuperscriptBox["\[Sigma]", "4"]}]}], ")"}]}], "+", 
               RowBox[{"3", " ", 
                SuperscriptBox["\[ExponentialE]", 
                 FractionBox[
                  RowBox[{"4", " ", 
                   SuperscriptBox["R", "2"]}], 
                  SuperscriptBox["\[Sigma]", "2"]]], " ", 
                SuperscriptBox["\[Rho]b", "3"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"240", " ", 
                   SuperscriptBox["R", "2"]}], "+", 
                  RowBox[{"184", " ", 
                   SuperscriptBox["\[Sigma]", "2"]}], "+", 
                  RowBox[{"5", " ", 
                   SuperscriptBox["\[Kappa]", "2"], " ", "\[Rho]b", " ", 
                   SuperscriptBox["\[Sigma]", "4"]}]}], ")"}]}]}], ")"}]}]}], 
           "-", 
           RowBox[{
            FractionBox["1", 
             RowBox[{"\[Pi]", " ", 
              SuperscriptBox["\[Kappa]", "2"], " ", 
              SuperscriptBox["\[Rho]m", "6"], " ", 
              SuperscriptBox["\[Sigma]", "6"]}]], 
            RowBox[{"2", " ", 
             SuperscriptBox["\[ExponentialE]", 
              FractionBox[
               RowBox[{"2", " ", 
                SuperscriptBox["R", "2"]}], 
               SuperscriptBox["\[Sigma]", "2"]]], " ", 
             SuperscriptBox["R", "2"], " ", 
             SuperscriptBox["\[Rho]b", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"1440", " ", 
                SuperscriptBox["\[ExponentialE]", 
                 FractionBox[
                  RowBox[{"4", " ", 
                   SuperscriptBox["R", "2"]}], 
                  SuperscriptBox["\[Sigma]", "2"]]], " ", "R", " ", 
                SuperscriptBox["\[Rho]b", "3"]}], "+", 
               RowBox[{"160", " ", 
                SuperscriptBox["\[ExponentialE]", 
                 FractionBox[
                  RowBox[{"3", " ", 
                   SuperscriptBox["R", "2"]}], 
                  SuperscriptBox["\[Sigma]", "2"]]], " ", "R", " ", 
                SuperscriptBox["\[Rho]b", "2"], " ", "\[Rho]m"}], "+", 
               RowBox[{"24", " ", 
                SuperscriptBox["\[ExponentialE]", 
                 FractionBox[
                  RowBox[{"2", " ", 
                   SuperscriptBox["R", "2"]}], 
                  SuperscriptBox["\[Sigma]", "2"]]], " ", "R", " ", 
                SuperscriptBox["\[Kappa]", "2"], " ", 
                SuperscriptBox["\[Rho]b", "2"], " ", 
                SuperscriptBox["\[Rho]m", "2"], " ", 
                SuperscriptBox["\[Sigma]", "2"]}], "-", 
               RowBox[{"6", " ", 
                SuperscriptBox["\[ExponentialE]", 
                 FractionBox[
                  SuperscriptBox["R", "2"], 
                  SuperscriptBox["\[Sigma]", "2"]]], " ", "R", " ", 
                SuperscriptBox["\[Kappa]", "2"], " ", "\[Rho]b", " ", 
                SuperscriptBox["\[Rho]m", "3"], " ", 
                SuperscriptBox["\[Sigma]", "2"]}], "+", 
               FractionBox[
                RowBox[{"12", " ", 
                 SuperscriptBox["\[ExponentialE]", 
                  FractionBox[
                   RowBox[{"3", " ", 
                    SuperscriptBox["R", "2"]}], 
                   SuperscriptBox["\[Sigma]", "2"]]], " ", "R", " ", 
                 SuperscriptBox["\[Rho]b", "2"], " ", "\[Rho]m", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"40", " ", 
                    SuperscriptBox["R", "2"]}], "+", 
                   RowBox[{"38", " ", 
                    SuperscriptBox["\[Sigma]", "2"]}], "+", 
                   RowBox[{"5", " ", 
                    SuperscriptBox["\[Kappa]", "2"], " ", "\[Rho]b", " ", 
                    SuperscriptBox["\[Sigma]", "4"]}]}], ")"}]}], 
                SuperscriptBox["\[Sigma]", "2"]], "+", 
               FractionBox[
                RowBox[{"24", " ", 
                 SuperscriptBox["\[ExponentialE]", 
                  FractionBox[
                   RowBox[{"4", " ", 
                    SuperscriptBox["R", "2"]}], 
                   SuperscriptBox["\[Sigma]", "2"]]], " ", "R", " ", 
                 SuperscriptBox["\[Rho]b", "3"], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"240", " ", 
                    SuperscriptBox["R", "2"]}], "+", 
                   RowBox[{"184", " ", 
                    SuperscriptBox["\[Sigma]", "2"]}], "+", 
                   RowBox[{"5", " ", 
                    SuperscriptBox["\[Kappa]", "2"], " ", "\[Rho]b", " ", 
                    SuperscriptBox["\[Sigma]", "4"]}]}], ")"}]}], 
                SuperscriptBox["\[Sigma]", "2"]]}], ")"}]}]}], "-", 
           RowBox[{
            FractionBox["1", 
             RowBox[{"2", " ", "\[Pi]", " ", 
              SuperscriptBox["\[Kappa]", "2"], " ", 
              SuperscriptBox["\[Rho]m", "6"], " ", 
              SuperscriptBox["\[Sigma]", "6"]}]], 
            RowBox[{
             SuperscriptBox["\[Rho]b", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "48"}], " ", 
                SuperscriptBox["\[ExponentialE]", 
                 FractionBox[
                  RowBox[{"4", " ", 
                   SuperscriptBox["R", "2"]}], 
                  SuperscriptBox["\[Sigma]", "2"]]], " ", "R", " ", 
                SuperscriptBox["\[Kappa]", "2"], " ", 
                SuperscriptBox["\[Rho]b", "2"], " ", 
                SuperscriptBox["\[Rho]m", "2"], " ", 
                SuperscriptBox["\[Sigma]", "4"]}], "+", 
               RowBox[{"24", " ", 
                SuperscriptBox["\[ExponentialE]", 
                 FractionBox[
                  RowBox[{"3", " ", 
                   SuperscriptBox["R", "2"]}], 
                  SuperscriptBox["\[Sigma]", "2"]]], " ", "R", " ", 
                SuperscriptBox["\[Kappa]", "2"], " ", "\[Rho]b", " ", 
                SuperscriptBox["\[Rho]m", "3"], " ", 
                SuperscriptBox["\[Sigma]", "4"]}], "-", 
               RowBox[{"8", " ", 
                SuperscriptBox["\[ExponentialE]", 
                 FractionBox[
                  RowBox[{"2", " ", 
                   SuperscriptBox["R", "2"]}], 
                  SuperscriptBox["\[Sigma]", "2"]]], " ", "R", " ", 
                SuperscriptBox["\[Kappa]", "2"], " ", 
                SuperscriptBox["\[Rho]m", "4"], " ", 
                SuperscriptBox["\[Sigma]", "4"]}], "-", 
               RowBox[{"4", " ", 
                SuperscriptBox["\[ExponentialE]", 
                 FractionBox[
                  RowBox[{"2", " ", 
                   SuperscriptBox["R", "2"]}], 
                  SuperscriptBox["\[Sigma]", "2"]]], " ", "R", " ", 
                SuperscriptBox["\[Kappa]", "2"], " ", 
                SuperscriptBox["\[Rho]m", "4"], " ", 
                SuperscriptBox["\[Sigma]", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"4", " ", 
                   SuperscriptBox["R", "2"]}], "+", 
                  SuperscriptBox["\[Sigma]", "2"]}], ")"}]}], "+", 
               RowBox[{"12", " ", 
                SuperscriptBox["\[ExponentialE]", 
                 FractionBox[
                  RowBox[{"3", " ", 
                   SuperscriptBox["R", "2"]}], 
                  SuperscriptBox["\[Sigma]", "2"]]], " ", "R", " ", 
                SuperscriptBox["\[Kappa]", "2"], " ", "\[Rho]b", " ", 
                SuperscriptBox["\[Rho]m", "3"], " ", 
                SuperscriptBox["\[Sigma]", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"6", " ", 
                   SuperscriptBox["R", "2"]}], "+", 
                  SuperscriptBox["\[Sigma]", "2"]}], ")"}]}], "-", 
               RowBox[{"24", " ", 
                SuperscriptBox["\[ExponentialE]", 
                 FractionBox[
                  RowBox[{"4", " ", 
                   SuperscriptBox["R", "2"]}], 
                  SuperscriptBox["\[Sigma]", "2"]]], " ", "R", " ", 
                SuperscriptBox["\[Kappa]", "2"], " ", 
                SuperscriptBox["\[Rho]b", "2"], " ", 
                SuperscriptBox["\[Rho]m", "2"], " ", 
                SuperscriptBox["\[Sigma]", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"8", " ", 
                   SuperscriptBox["R", "2"]}], "+", 
                  SuperscriptBox["\[Sigma]", "2"]}], ")"}]}], "-", 
               RowBox[{"4", " ", 
                SuperscriptBox["\[ExponentialE]", 
                 FractionBox[
                  RowBox[{"5", " ", 
                   SuperscriptBox["R", "2"]}], 
                  SuperscriptBox["\[Sigma]", "2"]]], " ", 
                SuperscriptBox["\[Rho]b", "2"], " ", "\[Rho]m", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"320", " ", 
                   SuperscriptBox["R", "3"]}], "+", 
                  RowBox[{"168", " ", "R", " ", 
                   SuperscriptBox["\[Sigma]", "2"]}], "+", 
                  RowBox[{"20", " ", "R", " ", 
                   SuperscriptBox["\[Kappa]", "2"], " ", "\[Rho]b", " ", 
                   SuperscriptBox["\[Sigma]", "4"]}]}], ")"}]}], "-", 
               RowBox[{
                SuperscriptBox["\[ExponentialE]", 
                 FractionBox[
                  RowBox[{"6", " ", 
                   SuperscriptBox["R", "2"]}], 
                  SuperscriptBox["\[Sigma]", "2"]]], " ", 
                SuperscriptBox["\[Rho]b", "3"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"11520", " ", 
                   SuperscriptBox["R", "3"]}], "+", 
                  RowBox[{"4896", " ", "R", " ", 
                   SuperscriptBox["\[Sigma]", "2"]}], "+", 
                  RowBox[{"120", " ", "R", " ", 
                   SuperscriptBox["\[Kappa]", "2"], " ", "\[Rho]b", " ", 
                   SuperscriptBox["\[Sigma]", "4"]}]}], ")"}]}], "-", 
               FractionBox[
                RowBox[{"40", " ", 
                 SuperscriptBox["\[ExponentialE]", 
                  FractionBox[
                   RowBox[{"5", " ", 
                    SuperscriptBox["R", "2"]}], 
                   SuperscriptBox["\[Sigma]", "2"]]], " ", "R", " ", 
                 SuperscriptBox["\[Rho]b", "2"], " ", "\[Rho]m", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"80", " ", 
                    SuperscriptBox["R", "4"]}], "+", 
                   RowBox[{"84", " ", 
                    SuperscriptBox["R", "2"], " ", 
                    SuperscriptBox["\[Sigma]", "2"]}], "+", 
                   RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{"3", "+", 
                    RowBox[{"5", " ", 
                    SuperscriptBox["R", "2"], " ", 
                    SuperscriptBox["\[Kappa]", "2"], " ", "\[Rho]b"}]}], 
                    ")"}], " ", 
                    SuperscriptBox["\[Sigma]", "4"]}], "+", 
                   RowBox[{
                    SuperscriptBox["\[Kappa]", "2"], " ", "\[Rho]b", " ", 
                    SuperscriptBox["\[Sigma]", "6"]}]}], ")"}]}], 
                SuperscriptBox["\[Sigma]", "2"]], "-", 
               FractionBox[
                RowBox[{"12", " ", 
                 SuperscriptBox["\[ExponentialE]", 
                  FractionBox[
                   RowBox[{"6", " ", 
                    SuperscriptBox["R", "2"]}], 
                   SuperscriptBox["\[Sigma]", "2"]]], " ", "R", " ", 
                 SuperscriptBox["\[Rho]b", "3"], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"2880", " ", 
                    SuperscriptBox["R", "4"]}], "+", 
                   RowBox[{"2448", " ", 
                    SuperscriptBox["R", "2"], " ", 
                    SuperscriptBox["\[Sigma]", "2"]}], "+", 
                   RowBox[{"12", " ", 
                    RowBox[{"(", 
                    RowBox[{"12", "+", 
                    RowBox[{"5", " ", 
                    SuperscriptBox["R", "2"], " ", 
                    SuperscriptBox["\[Kappa]", "2"], " ", "\[Rho]b"}]}], 
                    ")"}], " ", 
                    SuperscriptBox["\[Sigma]", "4"]}], "+", 
                   RowBox[{"5", " ", 
                    SuperscriptBox["\[Kappa]", "2"], " ", "\[Rho]b", " ", 
                    SuperscriptBox["\[Sigma]", "6"]}]}], ")"}]}], 
                SuperscriptBox["\[Sigma]", "2"]]}], ")"}]}]}]}], 
          RowBox[{
           RowBox[{"R", "-", "\[Sigma]"}], "<", "0"}]},
         {"0", 
          TagBox["True",
           "PiecewiseDefault",
           AutoDelete->True]}
        },
        AllowedDimensions->{2, Automatic},
        Editable->True,
        GridBoxAlignment->{
         "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}},
           "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.84]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}},
        Selectable->True]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}},
     GridBoxItemSize->{
      "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.35]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    "Piecewise",
    DeleteWithContents->True,
    Editable->False,
    SelectWithContents->True,
    Selectable->False], ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.6708732898040533`*^9, 3.670873359678375*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Series", "[", 
  RowBox[{
   RowBox[{"a5", "[", 
    RowBox[{"R", ",", "\[Theta]", ",", "\[CurlyPhi]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Rho]m", ",", "\[Infinity]", ",", "2"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6708733808875465`*^9, 3.6708733945861063`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[GridBox[{
      {"\[Piecewise]", GridBox[{
         {
          InterpretationBox[
           RowBox[{
            FractionBox[
             RowBox[{"2", " ", 
              SuperscriptBox["\[ExponentialE]", 
               FractionBox[
                RowBox[{"2", " ", 
                 SuperscriptBox["R", "2"]}], 
                SuperscriptBox["\[Sigma]", "2"]]], " ", "R", " ", 
              SuperscriptBox["\[Rho]b", "2"]}], 
             RowBox[{"\[Pi]", " ", 
              SuperscriptBox["\[Sigma]", "2"], " ", 
              SuperscriptBox["\[Rho]m", "2"]}]], "+", 
            InterpretationBox[
             SuperscriptBox[
              RowBox[{"O", "[", 
               FractionBox["1", "\[Rho]m"], "]"}], "3"],
             SeriesData[$CellContext`\[Rho]m, 
              DirectedInfinity[1], {}, 2, 3, 1],
             Editable->False]}],
           SeriesData[$CellContext`\[Rho]m, 
            DirectedInfinity[1], {
            2 E^(2 $CellContext`R^2 $CellContext`\[Sigma]^(-2)) 
             Pi^(-1) $CellContext`R $CellContext`\[Rho]b^2 $CellContext`\
\[Sigma]^(-2)}, 2, 3, 1],
           Editable->False], 
          RowBox[{
           RowBox[{"R", "-", "\[Sigma]"}], "<", "0"}]},
         {"0", 
          TagBox["True",
           "PiecewiseDefault",
           AutoDelete->True]}
        },
        AllowedDimensions->{2, Automatic},
        Editable->True,
        GridBoxAlignment->{
         "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}},
           "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.84]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}},
        Selectable->True]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}},
     GridBoxItemSize->{
      "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.35]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    "Piecewise",
    DeleteWithContents->True,
    Editable->False,
    SelectWithContents->True,
    Selectable->False], ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.6708733958901157`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["misc equations", "Chapter",
 CellChangeTimes->{{3.670753059454095*^9, 3.670753072217473*^9}, {
  3.6708716755731144`*^9, 3.6708716764683666`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"f", "[", "R_", "]"}], ":=", 
  RowBox[{
   RowBox[{"-", 
    SuperscriptBox["m", "2"]}], " ", 
   FractionBox[
    RowBox[{"c1", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["R", 
        SuperscriptBox["m", "2"]], ")"}], "n"]}], 
    RowBox[{
     RowBox[{"c2", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["R", 
         SuperscriptBox["m", "2"]], ")"}], "n"]}], "+", 
     "1"}]]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fR", "[", "R_", "]"}], ":=", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"f", "[", "R", "]"}], ",", "R"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Series", "[", 
   RowBox[{
    RowBox[{"ReplaceAll", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "R"}], "+", 
       RowBox[{"fR", "[", "R", "]"}], "-", 
       RowBox[{"2", 
        RowBox[{"f", "[", "R", "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"n", "\[Rule]", "1"}], ",", 
        RowBox[{"R", "\[Rule]", " ", 
         RowBox[{"R", " ", 
          SuperscriptBox["m", "2"]}]}]}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"R", ",", "0", ",", "2"}], "}"}]}], "]"}], "/.", 
  RowBox[{"m", "\[Rule]", "0"}]}]}], "Input",
 CellChangeTimes->{{3.6707530851399813`*^9, 3.670753173013358*^9}, {
  3.670754364418365*^9, 3.670754402112054*^9}, {3.670754482346287*^9, 
  3.670754492236661*^9}, {3.670754777136602*^9, 3.670754804961952*^9}, {
  3.670755563856286*^9, 3.670755603608863*^9}, {3.670758116100893*^9, 
  3.670758130444352*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{"-", "c1"}], "+", 
   RowBox[{"2", " ", "c1", " ", "c2", " ", "R"}], "-", 
   RowBox[{"3", " ", 
    RowBox[{"(", 
     RowBox[{"c1", " ", 
      SuperscriptBox["c2", "2"]}], ")"}], " ", 
    SuperscriptBox["R", "2"]}], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "R", "]"}], "3"],
    SeriesData[$CellContext`R, 0, {}, 0, 3, 1],
    Editable->False]}],
  SeriesData[$CellContext`R, 
   0, {-$CellContext`c1, 
    2 $CellContext`c1 $CellContext`c2, (-3) $CellContext`c1 \
$CellContext`c2^2}, 0, 3, 1],
  Editable->False]], "Output",
 CellChangeTimes->{
  3.6707544532899637`*^9, 3.670754494389111*^9, {3.670754787801896*^9, 
   3.670754805737708*^9}, {3.670755576114059*^9, 3.670755605518238*^9}, {
   3.6707581176862717`*^9, 3.67075813156806*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Series", "[", 
   RowBox[{
    RowBox[{"ReplaceAll", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "R"}], "+", 
       RowBox[{"fR", "[", "R", "]"}], "-", 
       RowBox[{"2", 
        RowBox[{"f", "[", "R", "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"n", "\[Rule]", "2"}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"R", ",", "\[Infinity]", ",", "2"}], "}"}]}], "]"}], "/.", 
  RowBox[{"m", "\[Rule]", "0"}]}]], "Input",
 CellChangeTimes->{{3.670756722287346*^9, 3.670756723684136*^9}, {
   3.6707568305297318`*^9, 3.6707568307113132`*^9}, 3.67075813492756*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{"-", "R"}], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", 
      FractionBox["1", "R"], "]"}], "3"],
    SeriesData[$CellContext`R, 
     DirectedInfinity[1], {}, -1, 3, 1],
    Editable->False]}],
  SeriesData[$CellContext`R, 
   DirectedInfinity[1], {-1}, -1, 3, 1],
  Editable->False]], "Output",
 CellChangeTimes->{3.670756724401565*^9, 3.67075683141446*^9, 
  3.67075813549013*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"SeriesCoefficient", "[", 
   RowBox[{
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{"ReplaceAll", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "R"}], "+", 
         RowBox[{"fR", "[", "R", "]"}], "-", 
         RowBox[{"2", 
          RowBox[{"f", "[", "R", "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"n", "\[Rule]", "1"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"R", ",", "m", ",", "2"}], "}"}]}], "]"}], ",", "0"}], "]"}], "//",
   "Simplify"}]], "Input",
 CellChangeTimes->{{3.6707572047350063`*^9, 3.6707572495277987`*^9}, {
  3.670757644328891*^9, 3.670757651649239*^9}, {3.6707635046965923`*^9, 
  3.670763530521901*^9}}],

Cell[BoxData[
 RowBox[{"m", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    FractionBox[
     RowBox[{"c1", " ", "m", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", "c2"}], "+", 
        RowBox[{"2", " ", "m"}]}], ")"}]}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"c2", "+", "m"}], ")"}], "2"]]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.6707572054007177`*^9, 3.670757249896822*^9}, {
   3.670757646302462*^9, 3.670757652423098*^9}, 3.670763531105617*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{808, 621},
WindowMargins->{{208, Automatic}, {83, Automatic}},
FrontEndVersion->"10.0 for Microsoft Windows (64-bit) (July 1, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 104, 1, 101, "Title"],
Cell[CellGroupData[{
Cell[709, 27, 149, 2, 72, "Chapter"],
Cell[CellGroupData[{
Cell[883, 33, 6523, 165, 449, "Input"],
Cell[7409, 200, 2475, 56, 69, "Output"],
Cell[9887, 258, 1123, 23, 62, "Output"],
Cell[11013, 283, 1381, 30, 86, "Output"],
Cell[12397, 315, 1386, 30, 86, "Output"],
Cell[13786, 347, 1382, 30, 86, "Output"],
Cell[15171, 379, 1989, 45, 86, "Output"],
Cell[17163, 426, 1979, 45, 86, "Output"]
}, Open  ]],
Cell[19157, 474, 2615, 57, 128, "Input"],
Cell[CellGroupData[{
Cell[21797, 535, 781, 19, 52, "Input"],
Cell[22581, 556, 2852, 78, 162, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25470, 639, 805, 18, 52, "Input"],
Cell[26278, 659, 1590, 40, 68, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27905, 704, 955, 21, 52, "Input"],
Cell[28863, 727, 1296, 36, 68, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30196, 768, 1061, 24, 72, "Input"],
Cell[31260, 794, 5711, 152, 214, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[37020, 952, 151, 2, 72, "Chapter"],
Cell[37174, 956, 8143, 258, 432, "Text"],
Cell[45320, 1216, 2664, 69, 211, "Input"],
Cell[CellGroupData[{
Cell[48009, 1289, 177, 3, 31, "Input"],
Cell[48189, 1294, 12376, 288, 392, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[60614, 1588, 315, 9, 72, "Chapter"],
Cell[60932, 1599, 265, 7, 30, "Text"],
Cell[61200, 1608, 451, 11, 31, "Input"],
Cell[CellGroupData[{
Cell[61676, 1623, 175, 3, 31, "Input"],
Cell[61854, 1628, 20078, 443, 788, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[81969, 2076, 312, 8, 31, "Input"],
Cell[82284, 2086, 2791, 74, 74, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[85124, 2166, 152, 2, 72, "Chapter"],
Cell[CellGroupData[{
Cell[85301, 2172, 1557, 48, 117, "Input"],
Cell[86861, 2222, 831, 23, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[87729, 2250, 625, 17, 31, "Input"],
Cell[88357, 2269, 467, 15, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[88861, 2289, 719, 20, 52, "Input"],
Cell[89583, 2311, 548, 16, 49, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
